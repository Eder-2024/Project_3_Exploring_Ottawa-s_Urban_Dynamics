<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Accident Data Visualization Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 30px;
            background-color: #f9f9f9;
        }

        h1 {
            color: #333;
        }

        select, label {
            font-size: 16px;
            margin-bottom: 20px;
        }

        .nav-links {
            margin-top: 40px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0px 2px 8px rgba(0,0,0,0.1);
        }

        .nav-links h2 {
            margin-bottom: 15px;
        }

        .nav-links ul {
            list-style: none;
            padding: 0;
        }

        .nav-links li {
            margin-bottom: 10px;
        }

        .nav-links a {
            color: #007BFF;
            text-decoration: none;
            font-size: 16px;
        }

        .nav-links a:hover {
            text-decoration: underline;
        }

        #line-chart {
            margin-top: 30px;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
        }
    </style>
</head>
<body>
    <h1>Accident Data Visualization Dashboard</h1>

    <!-- Dropdown for filtering severity -->
    <label for="severity">Select Severity:</label>
    <select id="severity">
        <option value="all">All</option>
        <option value="01 - Minimal">Minimal</option>
        <option value="02 - Minor">Minor</option>
        <option value="03 - Major">Major</option>
        <option value="04 - Fatal">Fatal</option>
        <option value="blank">Unknown / Not Reported</option>
    </select>

    <!-- Line Chart Container -->
    <h2>Accident Trend Over Time</h2>
    <div id="line-chart" style="height: 500px;"></div>

    <!-- Navigation Links -->
    <div class="nav-links">
        <h2>Explore More Visualizations</h2>
        <ul>
            <li><a href="/histogram">View Histogram of Number of Vehicles Involved in Accidents</a></li>
            <li><a href="/boxplot">View Boxplot: Accident Severity by Road Surface Condition</a></li>
            <li><a href="/heatmap">Explore Accident Density with Interactive Heatmap</a></li>
            <li><a href="/linechart">Detailed Line Chart: Date vs Accident Count</a></li>
        </ul>
    </div>

    <script>
        function updateChart(severity) {
            fetch(`/api/linechart?severity=${severity}`)
                .then(res => res.json())
                .then(data => {
                    const dates = data.map(d => d.date);
                    const counts = data.map(d => d.accident_count);
                    Plotly.newPlot('line-chart', [{
                        x: dates,
                        y: counts,
                        type: 'scatter',
                        mode: 'lines+markers',
                        marker: { color: '#e74c3c' }
                    }], {
                        title: `Accidents Over Time (${severity === 'all' ? 'All Severities' : severity})`,
                        xaxis: { title: 'Date' },
                        yaxis: { title: 'Number of Accidents' }
                    });
                });
        }

        document.getElementById('severity').addEventListener('change', function () {
            updateChart(this.value);
        });

        // Load initial chart
        updateChart('all');
    </script>
</body>
</html>